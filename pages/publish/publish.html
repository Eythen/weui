<!DOCTYPE html>
<html>

	<head>
		<title>商机询盘</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="format-detection" content="telephone=no" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">

		<link rel="stylesheet" href="../../css/weui.min.css">
		<link rel="stylesheet" href="../../css/jquery-weui.css">
		<link rel="stylesheet" href="../../css/jquery-labelauty.css">
		<link rel="stylesheet" href="../../css/zyUpload.css" />
		<link rel="stylesheet" href="../../css/app.css">

		<style>
			body{background: #F5F5F5;}
			.weui-popup__modal .modal-content{padding-top: 44px;padding-bottom: 44px;}
			.scroll{background: #F5F5F5;position:absolute; overflow:scroll; -webkit-overflow-scrolling: touch; top:0; left:0; bottom:51px; right:0;}
			.weui-picker-container{ height: 100%;}
			.weui-picker-modal{ height: 200px; z-index: 1100;}
		</style>
	</head>

	<body ontouchstart>

        <div class="scroll">

			<!--询盘类型-->
			<div class="publish">
				<h1>询盘类型</h1>
			</div>
			<div class="publish_pd">
				<div class="publish_bj pd">
					<ul class="sort dowebok">
						<li><input type="checkbox" name="checkbox" data-labelauty="终端采购"></li>
						<li><input type="checkbox" name="checkbox" data-labelauty="普通采购"></li>
						<li><input type="checkbox" name="checkbox" data-labelauty="招标采购"></li>
						<li><input type="checkbox" name="checkbox" data-labelauty="二手信息"></li>
					</ul>
				</div>
				<div class="publish_bj pd0">
					<dl class="bui-accordion">
						<dt class="bui-btn active flip">
					        <div class="span1">分类</div>
					        <i class="icon-accordion"></i>
				        </dt>
						<dd class="panel" style="display: block;">
							<ul class="sort dowebok">
								<li><input type="checkbox" name="fruit" data-labelauty="发电机"></li>
								<li><input type="checkbox" name="fruit" data-labelauty="空压机"></li>
								<li><input type="checkbox" name="fruit" data-labelauty="工程建筑机械"></li>
								<li><input type="checkbox" name="fruit" data-labelauty="机床设备"></li>
								<li><input type="checkbox" name="fruit" data-labelauty="清洁设备"></li>
								<li><input type="checkbox" name="fruit" data-labelauty="制冷设备"></li>
							</ul>
						</dd>
					</dl>
				</div>
			</div>
			
			<!--询盘信息-->
			<div class="publish">
				<h1>询盘信息</h1>
			</div>
			<div class="publish_pd">
				<div class="publish_bj">
					<h2>询盘标题</h2>
					<textarea class="bui-textarea" id="buitextarea" rows="4" placeholder="请输入文本"></textarea>
					<div class="bui-counter"><span class="textareaInput">0</span>/<span>50</span></div>
				</div>
				<div class="publish_bj">
					<h2>询盘详情</h2>
					<textarea class="textarea-item" id="textareaitem" rows="4" placeholder="请输入文本"></textarea>
					<div class="bui-counter"><span class="number">0</span>/<span>200</span></div>
				</div>
				<div class="publish_bj pd0 shurk">
					<div class="weui-cells">
						<div class="weui-cell">
							<div class="weui-cell__hd">
								<label class="weui-label">联系人</label>
							</div>
							<div class="weui-cell__bd">
								<input class="weui-input" id="name" type="text" value="" placeholder="联系人">
							</div>
						</div>
						<div class="weui-cell">
							<div class="weui-cell__hd">
								<label class="weui-label">联系电话</label>
							</div>
							<div class="weui-cell__bd">
								<input class="weui-input" id="phone" type="tel" value="" placeholder="联系电话">
							</div>
						</div>
						<div class="weui-cell weui-cell_select">
							<div class="weui-cell__hd">
								<label class="weui-label">收货地</label>
							</div>
							<div class="weui-cell__bd">
								<input class="weui-input city" id="city" type="text" value="" placeholder="省、市、区选择">
							</div>
						</div>
						<div class="weui-cell">
							<div class="weui-cell__hd">
								<label class="weui-label">采购数量</label>
							</div>
							<div class="weui-cell__bd">
								<input class="weui-input" id="num" type="tel" value="" placeholder="采购数量">
							</div>
						</div>
						<div class="weui-cell">
							<div class="weui-cell__hd">
								<label class="weui-label">联系地址</label>
							</div>
							<div class="weui-cell__bd">
								<input class="weui-input" id="address" type="text" value="" placeholder="联系地址">
							</div>
						</div>
					</div>
				</div>
				<div class="publish_bj pd0">
					<h3>资料上传</h3>
					<div id="Dataupload" class="Dataupload"></div>
				</div>
				<div class="container-xy">
				    <div class="btn-primary">提交审核</div>
		        </div>
			</div>
		</div>


		<footer class="footer">
			<a href="../../index.html" class="item">
				<div class="icon">
					<img src="../../images/zs.png" />
				</div>
				<span class="text">询盘</span>
			</a>
			<a href="pages/publish/publish.html" class="item on">
				<div class="icon">
					<img src="../../images/fb_on.png" />
				</div>
				<span class="text">分布</span>
			</a>
			<a href="../mine/mine.html" class="item">
				<div class="icon">
					<img src="../../images/my.png" />
				</div>
				<span class="text">我的</span>
			</a>
		</footer>


		<script src="../../js/jquery-2.1.4.js"></script>
		<script src="../../js/fastclick.js"></script>
		<script>
			$(function() {
				FastClick.attach(document.body);
			});
		</script>
		<script src="../../js/zyFile.js"></script>
        <script src="../../js/zyUpload.js"></script>
        <script src="../../js/jquery-weui.js"></script>
        <script src="../../js/city-picker.js"></script>
        <script src="../../js/jquery-labelauty.js"></script>
        <script src="../../js/overscroll.js"></script>
        
		<script>
			// 美化多选复合框
			$('.dowebok :input').labelauty();
			
			// 多选效果
			$("#sort li").click(function() {
				var type = $(this).attr("date-type");
				var copyThisB = $(this).clone();
				if($(this).hasClass("selected")) {
					$("#sort li[date-type='" + type + "']").fadeToggle();
				}
				$(this).toggleClass("selected");
			});
			
			// 输了数量实时计算
			var lenInput = $('.bui-textarea').val().length;
			$(".bui-textarea").keyup(function() {
				lenInput = $(this).val().length;
				if(lenInput > 0 && lenInput <= 50) {
					$('.textareaInput').html(lenInput);
				}
			});
			var lenInput = $('.textarea-item').val().length;
			$(".textarea-item").keyup(function() {
				lenInput = $(this).val().length;
				if(lenInput > 0 && lenInput <= 200) {
					$('.number').html(lenInput);
				}
			});
			
			// 地区
			$("#city").cityPicker({
				title: "选择收货地",
				onChange: function(picker, values, displayValues) {
					console.log(values, displayValues);
				}
			});
			
			// 禁止手机自带键盘弹出
			$(".city").focus(function(){
		        document.activeElement.blur();
		    });
		    
		     
			$(document).ready(function(){
				$(".flip").click(function(){
				    $(".panel").toggle();
				});
			});

			
			// 资料上传
			$("#Dataupload").zyUpload({
				//width: "320px", // 宽度
				//height: "83px", // 宽度
				itemWidth: "83px", // 文件项的宽度
				itemHeight: "83px", // 文件项的高度
				url: "/upload/UploadAction", // 上传文件的路径
				multiple: true, // 是否可以多个文件上传
				//dragDrop: true, // 是否可以拖动上传文件
				del: true, // 是否可以删除文件
				finishDel: false, // 是否在上传文件完成后删除预览
				/* 外部获得的回调接口 */
				onSelect: function(files, allFiles) { // 选择文件的回调方法
					console.info("当前选择了以下文件：");
					console.info(files);
					console.info("之前没上传的文件：");
					console.info(allFiles);
				},
				onDelete: function(file, surplusFiles) { // 删除一个文件的回调方法
					console.info("当前删除了此文件：");
					console.info(file);
					console.info("当前剩余的文件：");
					console.info(surplusFiles);
				},
				onSuccess: function(file) { // 文件上传成功的回调方法
					console.info("此文件上传成功：");
					console.info(file);
				},
				onFailure: function(file) { // 文件上传失败的回调方法
					console.info("此文件上传失败：");
					console.info(file);
				},
				onComplete: function(responseInfo) { // 上传完成的回调方法
					console.info("文件上传完成");
					console.info(responseInfo);
				}
			})
			
			
			// 输入框判断
			$('.btn-primary').click(function() {
				var textarea1 = $("#buitextarea").val();
				var textarea2 = $("#textareaitem").val();
				var name = $("#name").val();
				var phone = $("#phone").val();
				var reg = /^1[3|4|5|7|8]\d{9}$/;
				var city = $("#city").val();
				var num = $("#num").val();
				var address = $("#address").val();
				var fileSubmit = $("#fileSubmit").val();
				if(textarea1 == '') {
					$.toast("询盘标题不能为空", "text");
					return false;
				} else if(textarea2 == '') {
					$.toast("询盘详情不能为空", "text");
					return false;
				} else if(name == '') {
					$.toast("联系人不能为空", "text");
					return false;
				} else if(phone == '') {
					$.toast("输入有效11位数手机号码", "text");
					return false;
				} else if(!reg.test(phone)) {
					$.toast("输入手机有误", "text");
					return false;
				} else if(city == '') {
					$.toast("收货地址不能为空", "text");
					return false;
				} else if(num == '') {
					$.toast("采购数量不能为空", "text");
					return false;
				} else if(address == '') {
					$.toast("联系地址不能为空", "text");
					return false;
				} else if(fileSubmit == '') {
					$.toast("请先选中文件再点击上传", "text");
				} else {
					$.showLoading();
					setTimeout(function() {
						$.hideLoading();
					}, 2000)
				}
			});
			
			     

		</script>
	</body>

</html>